myApp.controller("PetController",["$uibModal","$log","$routeParams","PetService","$http","TextService","UserListService","$location","$window","UploadService","FavoriteService","$scope",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=this;m.petList=[],m.message=d.allPets.message,e.get("/pets").then(function(a){a.data.user.username?(m.userName=a.data.user.username,m.phoneNumber=a.data.user.phone,m.houseHold=a.data.user.household,m.userList=[],g.getUserList().then(function(a){for(var b=0;b<a.length;b++)a[b].household===m.houseHold&&m.userList.push(a[b])}),d.getPetCare(m.houseHold).then(function(a){m.careList=a})):h.path("/home")}),m.getAllPets=function(){d.getAllPets().then(function(a){m.petList=[];for(var b=0;b<a.length;b++)a[b].household===m.houseHold&&m.petList.push(a[b])})},m.getAllPets(),m.addNewPet=function(){var a={name:m.name,breed:m.breed,color:m.color,age:m.age,agelength:m.agelength,care:m.care,owner:m.owner,feed:m.checkbox.feed,water:m.checkbox.water,walk:m.checkbox.walk,bathe:m.checkbox.bathe,treats:m.checkbox.treats,litter:m.checkbox.treats,household:m.houseHold,petimg:m.petImgUrl,favorites:[],gallery:[]};d.addNewPet(a).then(function(){m.name="",m.breed="",m.color="",m.age="",m.care="",m.owner="",m.checkbox.feed=!1,m.checkbox.water=!1,m.checkbox.walk=!1,m.checkbox.bathe=!1,m.checkbox.treats=!1,m.checkbox.litter=!1,m.uploadMessage=""})},m.removePet=function(){d.removePet(c.id).then(function(){h.path("/userHome")})},m.actionObject={care:[]},m.addAction=function(a,b){switch(b){case"Fed":m.actionObject.care.push(a+" was fed.");break;case"Given Water":m.actionObject.care.push(a+" was given water.");break;case"Walked":m.actionObject.care.push(a+" was taken on a walk.");break;case"Bathed":m.actionObject.care.push(a+" was given a bath.");break;case"Given Treat":m.actionObject.care.push(a+" was given a treat.");break;case"Changed Litter":m.actionObject.care.push(a+" had his/her litter changed.");break;default:alert("None of the cases were met")}},m.sendText=function(){for(var a="",b={action:m.actionObject,number:"",extra:m.observations},c=0;c<m.userList.length;c++)a="+1"+m.userList[c].phone,b.number=a,f.sendText(b);m.actionObject={care:[]},m.observations=""},m.uploadMessage="",m.showPicker=function(){m.petImgUrl="",j.showPicker().then(function(a){m.petImgUrl=a,m.uploadMessage="Picture has been uploaded!",l.$apply()})},m.showPickerForGallery=function(){j.showPicker().then(function(a){m.newPictureToAdd=a,m.uploadMessage="Picture has been uploaded!",console.log("just about to add another pet pic"),m.addAnotherPetPicture()})},m.getFavorites=function(){k.getFavorites().then(function(a){m.favoritesList=a})},m.addFavorite=function(){m.petIn=JSON.parse(m.petIn);var a=m.petIn,b=[m.itemType,m.item];a.favorites.push(b),k.addFavorite(a).then(function(){m.getAllPets(),m.item="",m.itemType=""})},m.indivName="",m.indivBreed="",m.indivColor="",m.indivAge="",m.indivPetimg="",m.indivOwner="",m.indivCare="",m.indivFavorites="",m.indivId=c.id,m.pet={},m.getIndividualPet=function(){m.indivId=c.id,m.pet={},d.getAllPets().then(function(a){for(var b=0;b<a.length;b++)a[b]._id===m.indivId&&(m.pet=a[b]);console.log("%%%%%%%%%%%%%%%%THIS IS THE PET",m.pet),m.indivName=m.pet.name,m.indivBreed=m.pet.breed,m.indivColor=m.pet.color,m.indivAge=m.pet.age+" "+m.pet.agelength,m.indivPetimg=m.pet.petimg,m.indivOwner=m.pet.owner,m.indivCare=m.pet.care,m.indivFavorites=m.pet.favorites,m.gallery=m.pet.gallery,console.log("This is the $routeParams.id",c.id)})},m.open=function(b,c){m.animationsEnabled=!0,m.getIndividualPet(),console.log("pet name:",m.indivName);var d=c?angular.element($document[0].querySelector(".modal-demo"+c)):void 0;console.log("this is the size and parentSelector",b,c);var e=a.open({animation:m.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"myModalContent.html",controller:"ModalInstanceController",controllerAs:"mic",size:b,appendTo:d,resolve:{title:function(){return"Edit Pet Information"}}}).result.then(function(){console.log("It was closed!"),m.getIndividualPet()});console.log("modalInstance:",e)},m.addAnotherPetPicture=function(){m.indivId=c.id,m.pet={},d.getAllPets().then(function(a){for(var b=0;b<a.length;b++)a[b]._id===m.indivId&&(m.pet=a[b]);console.log("This is the individual",m.pet),m.pet.gallery.push(m.newPictureToAdd),d.addAnotherPetPicture(m.pet).then(function(){m.getIndividualPet()})})}}]),myApp.controller("ModalInstanceController",["$uibModalInstance","title","PetService","$routeParams","UserListService","UploadService","$location",function(a,b,c,d,e,f,g){var h=this;h.title=b,console.log("vm.title:",h.title),h.ok=function(){a.close()},h.cancel=function(){a.dismiss("cancel")},h.indivId=d.id;var i={};c.getAllPets().then(function(a){for(var b=0;b<a.length;b++)a[b]._id===h.indivId&&(i=a[b]);console.log("%%%%%%%%%%%%%%%%THIS IS THE PET",i),h.indivName=i.name,h.indivBreed=i.breed,h.indivColor=i.color,h.indivAge=i.age,h.indivAgeLength=i.agelength,h.indivPetimg=i.petimg,h.indivOwner=i.owner,h.indivCare=i.care,h.indivFavorites=i.favorites,h.checkbox={},h.checkbox.feed=i.feed,h.checkbox.water=i.water,h.checkbox.walk=i.walk,h.checkbox.bathe=i.bathe,h.checkbox.treats=i.treats,h.checkbox.litter=i.litter,h.userList=[],e.getUserList().then(function(a){for(var b=0;b<a.length;b++)a[b].household===i.household&&h.userList.push(a[b])}),h.showPicker=function(){f.showPicker().then(function(a){h.indivPetimg=a})}}),h.removeFavorite=function(a){for(var b=[],c=0;c<h.indivFavorites.length;c++)h.indivFavorites[c]!==a&&b.push(h.indivFavorites[c]);h.indivFavorites=b},h.updatePet=function(){if(""===h.ownerChange||void 0===h.ownerChange)alert("Please Fill in the Owner Field!");else{var b={_id:i._id,name:h.changeName,breed:h.changeBreed,color:h.changeColor,age:h.changeAge,agelength:h.changeAgeLength,bathe:h.checkbox.bathe,care:h.careChange,favorites:h.indivFavorites,feed:h.checkbox.feed,household:i.household,litter:h.checkbox.litter,owner:h.ownerChange,petimg:h.indivPetimg,treats:h.checkbox.treats,walk:h.checkbox.walk,water:h.checkbox.water};c.updatePetInfo(b).then(function(){a.close()})}}}]);