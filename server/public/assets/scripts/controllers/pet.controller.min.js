myApp.controller("PetController",["$uibModal","$log","$routeParams","PetService","$http","TextService","UserListService","$location","$window","UploadService","FavoriteService",function(a,b,c,d,e,f,g,h,i,j,k){var l=this;l.petList=[],l.message=d.allPets.message,e.get("/pets").then(function(a){a.data.user.username?(l.userName=a.data.user.username,l.phoneNumber=a.data.user.phone,l.houseHold=a.data.user.household,l.userList=[],g.getUserList().then(function(a){for(var b=0;b<a.length;b++)a[b].household===l.houseHold&&l.userList.push(a[b])}),d.getPetCare(l.houseHold).then(function(a){l.careList=a})):h.path("/home")}),l.getAllPets=function(){d.getAllPets().then(function(a){l.petList=[];for(var b=0;b<a.length;b++)a[b].household===l.houseHold&&l.petList.push(a[b])})},l.getAllPets(),l.addNewPet=function(){var a={name:l.name,breed:l.breed,color:l.color,age:l.age,agelength:l.agelength,care:l.care,owner:l.owner,feed:l.checkbox.feed,water:l.checkbox.water,walk:l.checkbox.walk,bathe:l.checkbox.bathe,treats:l.checkbox.treats,litter:l.checkbox.treats,household:l.houseHold,petimg:l.petImgUrl,favorites:[],gallery:[]};d.addNewPet(a).then(function(){l.name="",l.breed="",l.color="",l.age="",l.care="",l.owner="",l.checkbox.feed=!1,l.checkbox.water=!1,l.checkbox.walk=!1,l.checkbox.bathe=!1,l.checkbox.treats=!1,l.checkbox.litter=!1,l.uploadMessage=""})},l.removePet=function(){d.removePet(c.id).then(function(){h.path("/userHome")})},l.actionObject={care:[]},l.addAction=function(a,b){switch(b){case"Fed":l.actionObject.care.push(a+" was fed.");break;case"Given Water":l.actionObject.care.push(a+" was given water.");break;case"Walked":l.actionObject.care.push(a+" was taken on a walk.");break;case"Bathed":l.actionObject.care.push(a+" was given a bath.");break;case"Given Treat":l.actionObject.care.push(a+" was given a treat.");break;case"Changed Litter":l.actionObject.care.push(a+" had his/her litter changed.");break;default:alert("None of the cases were met")}},l.sendText=function(){for(var a="",b={action:l.actionObject,number:"",extra:l.observations},c=0;c<l.userList.length;c++)a="+1"+l.userList[c].phone,b.number=a,f.sendText(b);l.actionObject={care:[]},l.observations=""},l.uploadMessage="",l.showPicker=function(){j.showPicker().then(function(a){l.petImgUrl=a,l.uploadMessage="Picture has been uploaded!"})},l.showPickerForGallery=function(){j.showPicker().then(function(a){l.newPictureToAdd=a,l.uploadMessage="Picture has been uploaded!",console.log("just about to add another pet pic"),l.addAnotherPetPicture()})},l.getFavorites=function(){k.getFavorites().then(function(a){l.favoritesList=a})},l.addFavorite=function(){l.petIn=JSON.parse(l.petIn);var a=l.petIn,b=[l.itemType,l.item];a.favorites.push(b),k.addFavorite(a).then(function(){l.getAllPets(),l.item="",l.itemType=""})},l.indivName="",l.indivBreed="",l.indivColor="",l.indivAge="",l.indivPetimg="",l.indivOwner="",l.indivCare="",l.indivFavorites="",l.indivId=c.id,l.pet={},l.getIndividualPet=function(){l.indivId=c.id,l.pet={},d.getAllPets().then(function(a){for(var b=0;b<a.length;b++)a[b]._id===l.indivId&&(l.pet=a[b]);console.log("%%%%%%%%%%%%%%%%THIS IS THE PET",l.pet),l.indivName=l.pet.name,l.indivBreed=l.pet.breed,l.indivColor=l.pet.color,l.indivAge=l.pet.age+" "+l.pet.agelength,l.indivPetimg=l.pet.petimg,l.indivOwner=l.pet.owner,l.indivCare=l.pet.care,l.indivFavorites=l.pet.favorites,l.gallery=l.pet.gallery,console.log("This is the $routeParams.id",c.id)})},l.open=function(b,c){l.animationsEnabled=!0,l.getIndividualPet(),console.log("pet name:",l.indivName);var d=c?angular.element($document[0].querySelector(".modal-demo"+c)):void 0;console.log("this is the size and parentSelector",b,c);var e=a.open({animation:l.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"myModalContent.html",controller:"ModalInstanceController",controllerAs:"mic",size:b,appendTo:d,resolve:{title:function(){return"Edit Pet Information"}}}).result.then(function(){console.log("It was closed!"),location.reload()});console.log("modalInstance:",e)},l.addAnotherPetPicture=function(){l.indivId=c.id,l.pet={},d.getAllPets().then(function(a){for(var b=0;b<a.length;b++)a[b]._id===l.indivId&&(l.pet=a[b]);console.log("This is the individual",l.pet),l.pet.gallery.push(l.newPictureToAdd),d.addAnotherPetPicture(l.pet).then(function(){l.getIndividualPet()})})}}]),myApp.controller("ModalInstanceController",["$uibModalInstance","title","PetService","$routeParams","UserListService","UploadService","$location",function(a,b,c,d,e,f,g){var h=this;h.title=b,console.log("vm.title:",h.title),h.ok=function(){a.close()},h.cancel=function(){a.dismiss("cancel")},h.indivId=d.id;var i={};c.getAllPets().then(function(a){for(var b=0;b<a.length;b++)a[b]._id===h.indivId&&(i=a[b]);console.log("%%%%%%%%%%%%%%%%THIS IS THE PET",i),h.indivName=i.name,h.indivBreed=i.breed,h.indivColor=i.color,h.indivAge=i.age,h.indivAgeLength=i.agelength,h.indivPetimg=i.petimg,h.indivOwner=i.owner,h.indivCare=i.care,h.indivFavorites=i.favorites,h.checkbox={},h.checkbox.feed=i.feed,h.checkbox.water=i.water,h.checkbox.walk=i.walk,h.checkbox.bathe=i.bathe,h.checkbox.treats=i.treats,h.checkbox.litter=i.litter,h.userList=[],e.getUserList().then(function(a){for(var b=0;b<a.length;b++)a[b].household===i.household&&h.userList.push(a[b])}),h.showPicker=function(){f.showPicker().then(function(a){h.indivPetimg=a})}}),h.removeFavorite=function(a){for(var b=[],c=0;c<h.indivFavorites.length;c++)h.indivFavorites[c]!==a&&b.push(h.indivFavorites[c]);h.indivFavorites=b},h.updatePet=function(){if(""===h.ownerChange||void 0===h.ownerChange)alert("Please Fill in the Owner Field!");else{var b={_id:i._id,name:h.changeName,breed:h.changeBreed,color:h.changeColor,age:h.changeAge,agelength:h.changeAgeLength,bathe:h.checkbox.bathe,care:h.careChange,favorites:h.indivFavorites,feed:h.checkbox.feed,household:i.household,litter:h.checkbox.litter,owner:h.ownerChange,petimg:h.indivPetimg,treats:h.checkbox.treats,walk:h.checkbox.walk,water:h.checkbox.water};c.updatePetInfo(b).then(function(){a.close()})}}}]);